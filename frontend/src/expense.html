<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FinTra</title>
    <link rel="stylesheet" href="css/pico.css">
    <link rel="stylesheet" href="css/pico.docs.css">
    <link rel="stylesheet" herf="css/switcher.css">
    <script src="js/themeswitcher.js" defer></script>
    <script src="js/expense.js" defer></script>
</head>

<body>
    <main class="container">
        <!-- Navigation Begin -->
        <aside>
            <nav>
                <ul>
                    <li>
                        <a href="/FinTra/frontend/src/index.html" class="secondary">Home</a>
                    </li>
                    <li>
                        <a href="/FinTra/frontend/src/income.html" class="secondary">Income Analysis</a>
                    </li>
                    <li>
                        <a href="/FinTra/frontend/src/expense.html">Expense Tracker</a>
                    </li>
                    <li>
                        <a class="secondary" aria-disabled="true"><s>Budget Manage</s></a>
                    </li>
                </ul>
            </nav>
        </aside>
        <!-- Navigation End -->
        <!-- Main Begin -->
        <div>
            <section>
                <hgroup>
                    <h1>Expense</h1>
                    <h2></h2>
                </hgroup>
                <nav>
                    <ul>
                        <li>
                            <a id="tabaddexpense">Add expense</a>
                        </li>
                    </ul>
                    <ul>
                        <li>
                            <a id="tabtransactions" class="secondary">Transactions</a>
                        </li>
                    </ul>
                    <ul>
                        <li>
                            <a id="tabwhatif" class="secondary">What If...?</a>
                        </li>
                    </ul>
                </nav>
                <!-- Add expense part Begin -->
                <section id="addexpense">
                    <form>
                        <label for="date">Date
                            <input type="date" id="date" name="date" required>
                        </label>

                        <label for="category">Category</label>
                        <select id="category" required>
                            <option value="" selected>Select a expense category</option>
                            <option value="">Expense</option>
                            <option value="">Spending</option>
                            <option value="">Transaction</option>
                        </select>

                        <label for="amount">Amount
                            <input type="number" id="amount" name="amount" placeholder="Amount" required>
                        </label>

                        <label for="note">Note
                            <input type="text" id="note" name="note" placeholder="Note (optional)">
                            <small></small>
                        </label>
                        <br>

                        <button type="submit">add new expense</button>
                    </form>
                </section>
                <!-- Add expense part End -->
                <!-- Transactions part Begin -->
                <section id="transactions" hidden>
                    <!--  -->
                </section>
                <!-- Transactions part End -->
                <!-- What If...? part Begin -->
                <section id="whatif">

                </section>
                <!-- What If...? part End -->
            </section>
        </div>
        <!-- Main End -->
    </main>
    <script src="js/pocketbase.umd.js"></script>
    <script type="text/javascript">
        const pb = new PocketBase("https://pb-fintra.fly.dev/");

        async function show_expense() {
            const records = await pb.collection('transactions').getFullList({
                sort: '-date',
            });
            const records_expense = records.filter((record) => record.inout === "expense");

            const total_expense = records_expense.reduce(
                (accumulator, currentValue) => accumulator + currentValue.amount, 0,
            );

            console.log(records_expense);

            records_expense.forEach((record) => {
                let section = document.createElement("section");
                section.innerHTML = `<span><strong>${record.inout.toUpperCase()}\)</strong></span><br><span>\> ${record.category}${record.source}</span> | <span>$ ${record.amount}</span> | <small>${record.date.substring(0, 10)}</small> : ${record.note}`;
                document.querySelector("section #transactions").appendChild(section);
            })
        }
        show_expense();
    </script>
</body>

</html>